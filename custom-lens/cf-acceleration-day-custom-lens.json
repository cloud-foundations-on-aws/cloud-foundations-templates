{
  "schemaVersion": "2021-11-01",
  "name": "AWS Cloud Foundations Accelerator",
  "description": "Track and Assess your progress in deploying an initial AWS Cloud Foundation multi-account environment.",
  "pillars": [
    {
      "id": "foundational_prerequisites",
      "name": "Foundational prerequisites",
      "questions": [
        {
          "id": "document_conventions_and_basic_governance",
          "title": "Document conventions and basic governance",
          "description": "Before you start creating an environment, you need to establish basic governance. Naming conventions are one of the most visible core governance procedures and they allow for planning at scale. Identifying a method to name your AWS accounts will enable you to effectively identify ownership or type of AWS account operating within your environment. Additionally, identifying the locations where your AWS management plane and operational workloads are will help you ensure your accounts are not inconsistently sprawled across AWS.",
          "choices": [
            {
              "id": "create_aws_account_email_naming_convention",
              "title": "Create AWS account email naming convention",
              "helpfulResource": {
                "displayText": "When creating new AWS accounts, you will need to use a unique email address that is associated with the root user of the account. To better manage your AWS environment as it scales, it is recommended to establish a naming convention for the account alias and the corresponding root account email address. We recommend using the same name used for the email as the AWS account alias.",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/console_account-alias.html#AboutAccountAlias"
              },
              "improvementPlan": {
                "displayText": "Create and document an AWS account email naming convention.",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/console_account-alias.html#AboutAccountAlias"
              }
            },
            {
              "id": "determine_home_region",
              "title": "Determine home region",
              "helpfulResource": {
                "displayText": "A home Region is where you deploy your AWS Organization management and orchestration tools such as AWS Control Tower and AWS IAM Identity Center. The home Region does not need to be the same as the operational Regions (where your workloads are deployed). If you do not have specific compliance requirements, we recommend choosing a home Region that supports the necessary AWS services such as AWS Control Tower and aligns with one of your operational Regions.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/region-how.html"
              },
              "improvementPlan": {
                "displayText": "Determine and document a home region for you AWS Organization.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/region-how.html"
              }
            },
            {
              "id": "determine_operational_regions",
              "title": "Determine operational regions",
              "helpfulResource": {
                "displayText": "Your operational Regions are AWS Regions where you will allow workloads to operate in. Operational Regions can be thought of as the AWS Regions where your end-user data is stored. All other AWS Regions should have controls put in place to restrict operational access. Your operational Region(s) can be the same as your home Region but can also include other Regions.",
                "url": "https://aws.amazon.com/blogs/architecture/what-to-consider-when-selecting-a-region-for-your-workloads/"
              },
              "improvementPlan": {
                "displayText": "Determine and document an operational region(s) for your AWS Organization.",
                "url": "https://aws.amazon.com/blogs/architecture/what-to-consider-when-selecting-a-region-for-your-workloads/"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "create_aws_account_email_naming_convention && determine_home_region && determine_operational_regions",
              "risk": "NO_RISK"
            },
            {
              "condition": "create_aws_account_email_naming_convention && determine_home_region && determine_operational_regions",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "create_management_account",
          "title": "Create management account",
          "description": "The management account is your first AWS account when onboarding is initiated. The initial setup requires information to create the account that is used during sign up. Once the AWS account is created, it is important to start with security in mind.",
          "choices": [
            {
              "id": "set_up_management_account_email_address",
              "title": "Set up management account email address",
              "helpfulResource": {
                "displayText": "When creating a new AWS account, you will need to supply an email address that has never been used for an AWS account. We recommend you setup a distribution group email and give it a title following the convention of- “aws-management-account-primary@example.com”, which maps the email address to functionality. This allows the members of the distribution list to recover access to the environment, and if an individual leaves your company or organization, they can be removed from the distribution list. Only add a small number of members to the group email as this email address is for the management account root administrative user.",
                "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_best-practices_mgmt-acct.html#best-practices_mgmt-acct_email-address"
              },
              "improvementPlan": {
                "displayText": "Set up a management account root user email address to create your first account.",
                "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_best-practices_mgmt-acct.html#best-practices_mgmt-acct_email-address"
              }
            },
            {
              "id": "create_aws_management_account",
              "title": "Create AWS management account",
              "helpfulResource": {
                "displayText": "The management account is the account that you use to create an AWS organization.  The management account has the responsibilities of a payer account and is responsible for paying all charges that are accrued by the member accounts. You can't change an organization's management account.",
                "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_getting-started_concepts.html"
              },
              "improvementPlan": {
                "displayText": "Create an AWS account which will be used as the organization's management account.",
                "url": "https://portal.aws.amazon.com/billing/signup#/start/email"
              }
            },
            {
              "id": "secure_management_account_root_user",
              "title": "Secure management account root user",
              "helpfulResource": {
                "displayText": "It is important to secure the root user and follow the AWS Best practices to protect the management account's root user.",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/best-practices-root-user.html"
              },
              "improvementPlan": {
                "displayText": "Follow the AWS best practices to secure the root user of the management account.",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/best-practices-root-user.html"
              },
              "additionalResources": [
                {
                  "type": "HELPFUL_RESOURCE",
                  "content": [
                    {
                      "displayText": "Enabling MFA on the AWS account root user",
                      "url": "https://docs.aws.amazon.com/accounts/latest/reference/best-practices-root-user.html"
                    }
                  ]
                }
              ]
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "set_up_management_account_email_address && create_aws_management_account && secure_management_account_root_user",
              "risk": "NO_RISK"
            },
            {
              "condition": "set_up_management_account_email_address && create_aws_management_account && secure_management_account_root_user",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "configure_management_account",
          "title": "Configure management account",
          "description": "The AWS management account root user is necessary to complete certain preliminary tasks within the management account.",
          "choices": [
            {
              "id": "allow_iam_role_access_to_billing",
              "title": "Allow IAM role access to billing",
              "helpfulResource": {
                "displayText": "This task requires the root user. By default, AWS does not provide access to any other IAM users or roles regardless of the permissions you give them. Enable the ability for IAM users, or roles, outside of the AWS root administrator account.  Once completed within the AWS management account, all AWS member accounts will inherit this setting.",
                "url": "https://docs.aws.amazon.com/console/iam/billing-enable"
              },
              "improvementPlan": {
                "displayText": "Follow IAM User guidance to enable IAM role access to billing",
                "url": "https://docs.aws.amazon.com/console/iam/billing-enable"
              }
            },
            {
              "id": "set_management_account_alternate_contacts_for_operations_security_billing",
              "title": "Set management account alternate contacts for operations, security, billing",
              "helpfulResource": {
                "displayText": "This task requires the root user. In order to keep the right teams or people notified, you can add an alternate contact for Billing, Operations, and Security communications for the AWS account.",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-alternate.html#manage-acct-update-contact-alternate-edit"
              },
              "improvementPlan": {
                "displayText": "Set the alternate contacts in the management account for Billing, Operations, and Security",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-alternate.html#manage-acct-update-contact-alternate-edit"
              }
            },
            {
              "id": "configure_billing_and_tax_information",
              "title": "Configure billing and tax information",
              "helpfulResource": {
                "displayText": "This task requires the root user. The AWS management account acts as the centralized billing entity, allowing you to receive a single invoice for all the AWS accounts within the organization. You will need to review and make any necessary changes to the billing console for the billing and tax information.",
                "url": "https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/manage-account-payment.html.html#manage-acct-update-contact-alternate-edit"
              },
              "improvementPlan": {
                "displayText": "Review and make any necessary changes to the billing console for tax, billing, and payment information.",
                "url": "https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/manage-account-payment.html.html#manage-acct-update-contact-alternate-edit"
              }
            },
            {
              "id": "select_aws_support_tier",
              "title": "Select AWS support tier",
              "helpfulResource": {
                "displayText": "You can change your AWS Support Plans for your account based on your business needs. Review the different AWS Support plans. By default, all AWS accounts receive Basic support. Changing the support plan requires the root user.",
                "url": "https://docs.aws.amazon.com/awssupport/latest/user/aws-support-plans.html"
              },
              "improvementPlan": {
                "displayText": "Review the different AWS support plans",
                "url": "https://docs.aws.amazon.com/awssupport/latest/user/changing-support-plans.html"
              },
              "additionalResources": [
                {
                  "type": "IMPROVEMENT_PLAN",
                  "content": [
                    {
                      "displayText": "If you would like to choose a higher level of support than Basic, change the support level in the management account",
                      "url": "https://docs.aws.amazon.com/awssupport/latest/user/changing-support-plans.html"
                    }
                  ]
                }
              ]
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "allow_iam_role_access_to_billing && set_management_account_alternate_contacts_for_operations_security_billing && configure_billing_and_tax_information && select_aws_support_tier",
              "risk": "NO_RISK"
            },
            {
              "condition": "allow_iam_role_access_to_billing && !set_management_account_alternate_contacts_for_operations_security_billing && !select_aws_support_tier && configure_billing_and_tax_information",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        }
      ]
    },
    {
      "id": "landing_zone",
      "name": "Landing Zone",
      "questions": [
        {
          "id": "aws_control_tower_deployment_and_configuration",
          "title": "AWS Control Tower deployment and configuration",
          "description": "AWS Control Tower is a managed service that orchestrates the deployment of resources to apply a consistent security configuration baseline across your AWS accounts and AWS environment. We recommend deploying AWS Control Tower as the orchestration tool to set up your initial AWS environment and apply post-deployment configurations.  During AWS Control Tower setup, you need to apply several parameters for deployment.",
          "choices": [
            {
              "id": "document_control_tower_required_parameters",
              "title": "Document Control Tower required parameters",
              "helpfulResource": {
                "displayText": "Before you deploy AWS Control Tower, we recommend that you collect and document the configuration parameters for your initial AWS Control Tower deployment (home region, operating regions, OU names, shared account names and unique email addresses). This will help ensure you adhere to the policies when setting up your environment on AWS and follow a naming convention from the start, allowing you to scale later on.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/step-two.html"
              },
              "improvementPlan": {
                "displayText": "Review and document the necessary AWS Control Tower parameters",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/step-two.html"
              }
            },
            {
              "id": "deploy_aws_control_tower_in_your_home_region",
              "title": "Deploy Control Tower in your home region",
              "helpfulResource": {
                "displayText": "Before AWS Control Tower sets up the landing zone, it automatically runs a series of pre-launch checks in your account. There's no action required on your part for these checks, which ensure that your management account is ready for the changes that establish your landing zone.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/getting-started-with-control-tower.html"
              },
              "improvementPlan": {
                "displayText": "Deploy AWS Control Tower in your home region using the parameters that you have documented",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/getting-started-with-control-tower.html"
              }
            },
            {
              "id": "use_control_tower_admin_aws_iam_identity_center_user",
              "title": "Use Control Tower admin AWS IAM Identity Center User",
              "helpfulResource": {
                "displayText": "We recommend that you do not use the AWS IAM root user accounts except for activities that require it. Reference AWS documentation for tasks that require the root user for more information.  AWS Control Tower enables IAM Identity Center (if not already enabled) and creates standard groups and permission sets.  AWS Control Tower also creates an IAM Identity Center User from the account (root user) email address.  This user can be used to login to the management account to avoid using the root user by using the link sent to the root user email address to set the password and login as a Control Tower IAM Identity Center admin.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/sso.html"
              },
              "improvementPlan": {
                "displayText": "Set the password and login to the management account using Control Tower IAM Identity Center admin user",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/get-started-use-identity-center-directory-create-user-in-identity-center.html"
              },
              "additionalResources": [
                {
                  "type": "HELPFUL_RESOURCE",
                  "content": [
                    {
                      "displayText": "Root user tasks",
                      "url": "https://docs.aws.amazon.com/accounts/latest/reference/root-user-tasks.html"
                    },
                    {
                      "displayText": "About AWS IAM Identity Center",
                      "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/what-is.html"
                    }
                  ]
                }
              ]
            },
            {
              "id": "configure_aws_control_tower_account_factory",
              "title": "Configure AWS Control Tower Account Factory",
              "helpfulResource": {
                "displayText": "AWS Control Tower account factory enables customers to provision accounts within organization under the governance of AWS Control Tower. AWS Control Tower account factory is configured, by default, to provision a virtual private cloud (VPC) and subnet in each new account. It is recommended to configure AWS Control Tower Account Factory default settings to not provision a default VPC(s) in new accounts. This will allow for greater control of your VPCs, subnets, and classless inter-domain routing (CIDR) ranges.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/configuring-account-factory-with-VPC-settings.html"
              },
              "improvementPlan": {
                "displayText": "Follow the AWS Control Tower guidance to configure Account Factory to not deploy VPCs",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/configuring-account-factory-with-VPC-settings.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "document_control_tower_required_parameters && deploy_aws_control_tower_in_your_home_region && configure_aws_control_tower_account_factory",
              "risk": "NO_RISK"
            },
            {
              "condition": "deploy_aws_control_tower_in_your_home_region && configure_aws_control_tower_account_factory && !document_control_tower_required_parameters",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "create_foundational_ous_from_control_tower",
          "title": "Create Foundational OUs from Control Tower",
          "description": "Foundational OUs are OUs that contains accounts, workloads, and other AWS resources that provide common security and infrastructure capabilities to secure and support your overall AWS environment. It is important to establish the foundational OUs early on.",
          "choices": [
            {
              "id": "create_infrastructure_ou",
              "title": "Create Infrastructure OU",
              "helpfulResource": {
                "displayText": "The Infrastructure Organizational Unit (OU) is intended for shared infrastructure services. It is designed to be used to hold AWS accounts containing AWS infrastructure resources that are shared or utilized by the rest of the organization. No application accounts or application workloads are intended to exist within this OU.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/infrastructure-ou-and-accounts.html"
              },
              "improvementPlan": {
                "displayText": "Follow the AWS Control Tower documentation to create and enroll a top-level OU (select Root for the Parent OU) named Infrastructure.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/create-new-ou.html"
              },
              "additionalResources": [
                {
                  "type": "HELPFUL_RESOURCE",
                  "content": [
                    {
                      "displayText": "Organizing your AWS environment whitepaper",
                      "url": "https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/organizing-workload-oriented-ous.html"
                    },
                    {
                      "displayText": "AWS Control Tower guidance on creating OUs",
                      "url": "https://docs.aws.amazon.com/controltower/latest/userguide/create-new-ou.html"
                    }
                  ]
                }
              ]
            },
            {
              "id": "create_workloads_ou",
              "title": "Create Workloads OU",
              "helpfulResource": {
                "displayText": "The Workloads Organizational Unit (OU) is intended to hold your business-specific workloads including both production and non-production environments. To maintain a clear separation between production and non-production workloads, you will be able create a Production and one or more Non-production OUs within the Workload OU. Reference the Organizing Workload-oriented OUs section of the AWS multi-account strategy whitepaper for more information.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/workloads-ou.html"
              },
              "improvementPlan": {
                "displayText": "Follow the AWS Control Tower documentation to create and enroll a top-level OU (select Root for the Parent OU) named Workloads.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/create-new-ou.html"
              },
              "additionalResources": [
                {
                  "type": "HELPFUL_RESOURCE",
                  "content": [
                    {
                      "displayText": "Organizing your AWS environment whitepaper",
                      "url": "https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/organizing-workload-oriented-ous.html"
                    },
                    {
                      "displayText": "AWS Control Tower guidance on creating OUs",
                      "url": "https://docs.aws.amazon.com/controltower/latest/userguide/create-new-ou.html"
                    }
                  ]
                }
              ]
            },
            {
              "id": "create_exceptions_ou",
              "title": "Create Exceptions OU",
              "helpfulResource": {
                "displayText": "The Exceptions Organizational Unit (OU) is designed to be a service control policy (SCP) exception OU. Therefore, SCPs should not be attached to this OU outside of the AWS Control Tower mandatory preventative controls Instead, SCPs should be attached directly to the accounts within this OU to provide the flexibility to manage different types of exceptions. For more information, visit the Exceptions OU section of the Organizing Your AWS Environment whitepaper for more information.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/exceptions-ou.html"
              },
              "improvementPlan": {
                "displayText": "Follow the AWS Control Tower documentation to create and enroll a top-level OU (select Root for the Parent OU) named Exceptions.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/create-new-ou.html"
              },
              "additionalResources": [
                {
                  "type": "HELPFUL_RESOURCE",
                  "content": [
                    {
                      "displayText": "Organizing your AWS environment whitepaper",
                      "url": "https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/exceptions-ou.html"
                    },
                    {
                      "displayText": "AWS Control Tower guidance on creating OUs",
                      "url": "https://docs.aws.amazon.com/controltower/latest/userguide/create-new-ou.html"
                    }
                  ]
                }
              ]
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "create_infrastructure_ou && create_workloads_ou && create_exceptions_ou",
              "risk": "NO_RISK"
            },
            {
              "condition": "create_infrastructure_ou && create_workloads_ou && !create_exceptions_ou",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        }
      ]
    },
    {
      "id": "identity",
      "name": "Identity",
      "questions": [
        {
          "id": "configure_aws_iam_identity_center",
          "title": "Configure AWS IAM Identity Center",
          "description": "IAM Identity Center (IdC) stores administrative permission settings that specify the amount of access granted to users and groups for an AWS account. After enabling IAM Identity Center and creating a permission set, the identity provider must be configured to support best practices.",
          "choices": [
            {
              "id": "set_mfa_in_aws_iam_identity_center",
              "title": "Set MFA in AWS IAM Identity Center",
              "helpfulResource": {
                "displayText": "It is recommended to enable Multi-Factor-Authentication (MFA) for AWS IAM Identity Center users. This is enabled from the IAM Identity Center web console by setting the option to configure MFA enforcement which will not allow users to log in for the first time until they configure an MFA device.",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/how-to-configure-mfa-device-enforcement.html"
              },
              "improvementPlan": {
                "displayText": "Follow the IAM Identity Center User Guide to configure MFA for IAM Identity Center users",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/how-to-configure-mfa-device-enforcement.html"
              }
            },
            {
              "id": "enable_abac_in_aws_iam_identity_center",
              "title": "Enable ABAC in AWS IAM Identity Center",
              "helpfulResource": {
                "displayText": "Attribute-based access control (ABAC) is an authorization strategy that defines permissions based on attributes. It is recommended to enable ABAC, even if it is not immediately required, to allow for its use in the future.",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/configure-abac.html"
              },
              "improvementPlan": {
                "displayText": "Enable ABAC in IAM Identity Center by following the guidance for enabling attributes for access control.",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/configure-abac.html"
              }
            },
            {
              "id": "configure_idc_url_in_aws_iam_center",
              "title": "Configure IdC URL in AWS IAM Identity Center",
              "helpfulResource": {
                "displayText": "To make accessing your AWS environment easier for your users, you can set a customized portal URL in AWS IAM Identity Center.",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/howtochangeURL.html"
              },
              "improvementPlan": {
                "displayText": "Create a customized portal URL in AWS IAM Identity Center.",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/howtochangeURL.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "set_mfa_in_aws_iam_identity_center && enable_abac_in_aws_iam_identity_center && configure_idc_url_in_aws_iam_center",
              "risk": "NO_RISK"
            },
            {
              "condition": "set_mfa_in_aws_iam_identity_center && !enable_abac_in_aws_iam_identity_center && !configure_idc_url_in_aws_iam_center",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "discontinue_use_of_management_account_root_user",
          "title": "Discontinue use of management account root user",
          "description": "When you first create an Amazon Web Services (AWS) account, you begin with a single sign-in identity that has complete access to all AWS services and resources in the account. This identity is called the AWS account root user and is accessed by signing in with the email address and password that you used to create the account.",
          "choices": [
            {
              "id": "use_aws_iam_identity_center_for_account_access",
              "title": "Use AWS IAM Identity center for account access",
              "helpfulResource": {
                "displayText": "We strongly recommend that you do not use the root user for your everyday tasks, even the administrative ones. As a best practice, safeguard your root user credentials and don't use them for everyday tasks. Root user credentials are only required to perform a few account and service management tasks.",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html"
              },
              "improvementPlan": {
                "displayText": "Use AWS IAM Identity Center users to access your accounts.",
                "url": "https://docs.aws.amazon.com/singlesignon/latest/userguide/what-is.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "use_aws_iam_identity_center_for_account_access",
              "risk": "NO_RISK"
            },
            {
              "condition": "use_aws_iam_identity_center_for_account_access",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        }
      ]
    },
    {
      "id": "finance",
      "name": "Finance",
      "questions": [
        {
          "id": "configure_for_cost_viewing_and_analysis",
          "title": "Configure for cost viewing and analysis",
          "description": "In order to analyze and report on your AWS cost, it is necessary to complete some preliminary steps to configure AWS services and features.",
          "choices": [
            {
              "id": "enable_cost_explorer_in_management_account",
              "title": "Enable Cost Explorer in management account",
              "helpfulResource": {
                "displayText": "AWS Cost Explorer is a tool that enables you to view and analyze your AWS costs and usage. Enabling AWS Cost Explorer in the management account allows you to analyze AWS cost and usage for your entire AWS Organization. In order to use Cost Explorer, it must be enabled. Note that Cost Explorer will take approximately 24 hours to generate the current month’s costs. The trailing 12-month costs and 12-month forecast will be available a few days later. Also note that AWS Cost Explorer can only be enabled through the console.",
                "url": "https://docs.aws.amazon.com/cost-management/latest/userguide/ce-what-is.html"
              },
              "improvementPlan": {
                "displayText": "Enable Cost Explorer in the management account following the Cost Management user guide for enabling Cost Explorer.",
                "url": "https://docs.aws.amazon.com/cost-management/latest/userguide/ce-enable.html"
              }
            },
            {
              "id": "enable_cost_allocation_tags",
              "title": "Enable Cost Allocation Tags",
              "helpfulResource": {
                "displayText": "Cost allocation tags allow you to track your AWS costs on a detailed level. After you activate cost allocation tags, AWS uses the cost allocation tags to organize your resource costs on your cost allocation report, to make it easier for you to categorize and track your AWS costs. AWS provides two types of cost allocation tags, an AWS generated tags and user-defined tags.",
                "url": "https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html"
              },
              "improvementPlan": {
                "displayText": "Activate the AWS-generated cost allocation tags in the management account following the guidance in the AWS Billing User guide.",
                "url": "https://us-east-1.console.aws.amazon.com/billing/home?region=us-east-1#/tags"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "enable_cost_explorer_in_management_account && enable_cost_allocation_tags",
              "risk": "NO_RISK"
            },
            {
              "condition": "enable_cost_explorer_in_management_account && enable_cost_allocation_tags",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "analyze_and_report_on_cost",
          "title": "Analyze and report on cost",
          "description": "The AWS Cost and Use Reports (AWS CUR) provide the most detailed cost and usage statistics available. You may utilize AWS Cost and Usage Reports to publish your AWS billing reports to a bucket owned by you on Amazon Simple Storage Service (Amazon S3).",
          "choices": [
            {
              "id": "create_s3_bucket_for_cost_and_usage_reports",
              "title": "Create S3 Bucket for Cost and Usage Reports",
              "helpfulResource": {
                "displayText": "In order to use Cost and Usage Reports, you must have an Amazon S3 bucket in your AWS account to receive and store the reports.  The bucket can be created in the console as you create a Cost and Usage report or created separately.",
                "url": "https://docs.aws.amazon.com/cur/latest/userguide/cur-s3.html"
              },
              "improvementPlan": {
                "displayText": "Create an Amazon S3 bucket to use as a destination for AWS CUR.",
                "url": "https://docs.aws.amazon.com/cur/latest/userguide/cur-s3.html"
              }
            },
            {
              "id": "enable_cost_and_usage_reports",
              "title": "Enable Cost and Usage Reports",
              "helpfulResource": {
                "displayText": "Unless a different format is required, it is recommended to configure the CUR for data integration with Amazon Athena.",
                "url": "https://docs.aws.amazon.com/cur/latest/userguide/cur-create.html"
              },
              "improvementPlan": {
                "displayText": "Create and configure Cost and Usage reports (CURs) following the AWS Cost and Usage Reports User Guide.",
                "url": "https://docs.aws.amazon.com/cur/latest/userguide/cur-create.html"
              }
            },
            {
              "id": "querying_cost_and_usage_reports_using_amazon_athena",
              "title": "Querying Cost and Usage Reports using Amazon Athena",
              "helpfulResource": {
                "displayText": "Amazon Athena is a serverless query service that you can use to analyze the data from your AWS Cost and Usage Reports (AWS CUR) in Amazon Simple Storage Service (Amazon S3) using standard SQL.",
                "url": "https://docs.aws.amazon.com/cur/latest/userguide/use-athena-cf.html"
              },
              "improvementPlan": {
                "displayText": "Follow the Amazon Athena User Guide to setup Athena to query your AWS CUR.",
                "url": "https://docs.aws.amazon.com/cur/latest/userguide/use-athena-cf.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "create_s3_bucket_for_cost_and_usage_reports && enable_cost_and_usage_reports && querying_cost_and_usage_reports_using_amazon_athena",
              "risk": "NO_RISK"
            },
            {
              "condition": "create_s3_bucket_for_cost_and_usage_reports && enable_cost_and_usage_reports && querying_cost_and_usage_reports_using_amazon_athena",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        }
      ]
    },
    {
      "id": "security",
      "name": "Security",
      "questions": [
        {
          "id": "set_member_account_alternate_contacts",
          "title": "Set member account alternate contacts",
          "description": "Manage the contact details for your member AWS accounts to help deliver timely information to the appropriate audience. These alternate contacts are used for messaging and alerting for the specific member AWS account activity. Every AWS account will have the following alternate account contacts- Billing, Operations, and Security.",
          "choices": [
            {
              "id": "enable_management_account_to_manage_alternate_contacts_of_member_accounts",
              "title": "Enable management account to manage alternate contacts of member accounts",
              "helpfulResource": {
                "displayText": "In order to manage the alternate contacts for member accounts in the organization, trusted access for AWS Account Management must be enabled.",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/using-orgs-trusted-access.html"
              },
              "improvementPlan": {
                "displayText": "Enable trusted access for AWS management account to manage alternate contacts of member accounts",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/using-orgs-trusted-access.html"
              }
            },
            {
              "id": "set_member_account_alternate_contacts_for_operations_security_billing",
              "title": "Set member account alternate contacts for operations, security, billing",
              "helpfulResource": {
                "displayText": "In order to ensure the right people are notified, you need to add an alternate contact for Billing, Operations, and Security communications for member accounts AWS account.  Once trusted access is enabled, this can be done from the management account.",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-alternate.html#manage-acct-update-contact-alternate-orgs"
              },
              "improvementPlan": {
                "displayText": "Set alternate contacts for all member accounts from the management account",
                "url": "https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-alternate.html#manage-acct-update-contact-alternate-orgs"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "enable_management_account_to_manage_alternate_contacts_of_member_accounts && set_member_account_alternate_contacts_for_operations_security_billing",
              "risk": "NO_RISK"
            },
            {
              "condition": "enable_management_account_to_manage_alternate_contacts_of_member_accounts && set_member_account_alternate_contacts_for_operations_security_billing",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "harden_management_account",
          "title": "Harden management account",
          "description": "Due to the critical nature of the management account, it is recommended to harden the management account by configuring alerting,  networking, and access.",
          "choices": [
            {
              "id": "delete_default_network_resources_in_management_account",
              "title": "Delete default network resources in management account",
              "helpfulResource": {
                "displayText": "When you create a new account, a default VPC is available in each AWS Region. A default VPC comes with a public subnet in each Availability Zone, an internet gateway, and settings to enable DNS resolution. AWS Control Tower will remove the default VPC from the AWS Control Tower governed Regions of Control Tower created accounts. However it will not remove resources from your management account. Due to this, we recommend you delete the management account default VPCs yourself.",
                "url": "https://docs.aws.amazon.com/vpc/latest/userguide/default-vpc.html"
              },
              "improvementPlan": {
                "displayText": "Delete default network resources in all regions of management account",
                "url": "https://github.com/cloud-foundations-on-aws/cloud-foundations-templates/tree/main/network/network-default-vpc-deletion"
              }
            },
            {
              "id": "configure_management_account_alerting_for_root_user_login",
              "title": "Configure management account alerting for root user login",
              "helpfulResource": {
                "displayText": "AWS Control Tower configures the organization AWS CloudTrail to send CloudTrail events to an Amazon CloudWatch Log group in the management account. This allows you to create a CloudWatch alarm based on log patterns in a CloudTrail CloudWatch Log group. Because Service Control Policies do not apply to the management account, it is important to configure alerting in the management account on unwanted events. A CloudWatch metric filter and alarm can be created using the CloudTrail log group to alert on root user logins to notify if the root user accesses the management account.",
                "url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/CreateMetricFilterProcedure.html"
              },
              "improvementPlan": {
                "displayText": "Create a metric filter and alarm for root user logins",
                "url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/CreateMetricFilterProcedure.html"
              }
            },
            {
              "id": "remove_unnecessary_iam_users_in_management_account",
              "title": "Remove unnecessary IAM users in management account",
              "helpfulResource": {
                "displayText": "To strengthen the security of your AWS account, delete any unnecessary IAM user credentials (passwords and access keys). We strongly recommend that your management account should not have any IAM users and that you use AWS Identity Center users for standard use.",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_manage.html#:~:text=AWS%20API%3A%20UpdateUser-,Deleting%20an%20IAM%20user,-You%20might%20delete"
              },
              "improvementPlan": {
                "displayText": "Delete unnecessary IAM users from management account",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_manage.html#:~:text=AWS%20API%3A%20UpdateUser-,Deleting%20an%20IAM%20user,-You%20might%20delete"
              }
            },
            {
              "id": "deploy_aws_config_in_all_allowed_regions_of_management_account",
              "title": "Deploy AWS Config in all allowed regions of management account",
              "helpfulResource": {
                "displayText": "AWS Control Tower deploys AWS Config (an AWS Config Recorder and AWS Config Delivery Channel) in each Control Tower managed region of each member account but it does not deploy AWS Config to the management account.  Although it is recommended to not deploy workload resources in the management account, due to the critical nature of the management account, we recommend deploying AWS Config in each region of the management account to track resources and allow alerting on those resources.",
                "url": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html"
              },
              "improvementPlan": {
                "displayText": "Deploy AWS Config to all enabled regions of the management account",
                "url": "https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html"
              }
            },
            {
              "id": "set_s3_public_block_access_in_management_account",
              "title": "Set S3 public block access in management account",
              "helpfulResource": {
                "displayText": "By default, new S3 buckets and objects don't allow public access. However, users can modify bucket policies, or object permissions to allow public access.  It is a good practice to enable S3 block public access at the account level to ensure that data is not exposed publicly.",
                "url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/configuring-block-public-access-account.html"
              },
              "improvementPlan": {
                "displayText": "Configure S3 block public access in the management account",
                "url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/configuring-block-public-access-account.html"
              }
            },
            {
              "id": "configure_iam_password_policy_in_management_account",
              "title": "Configure IAM password policy in management account",
              "helpfulResource": {
                "displayText": "You can set a custom password policy on your AWS account to specify complexity requirements and mandatory rotation periods for your IAM users' passwords. If you don't set a custom password policy, the default AWS password policy will be used. Although it is not recommended to use IAM users unless absolutely required, it is a best practice to configure the password policy to meet your companies password requirements.",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
              },
              "improvementPlan": {
                "displayText": "Configure the IAM password policy in the management account",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "delete_default_network_resources_in_management_account && configure_management_account_alerting_for_root_user_login && remove_unnecessary_iam_users_in_management_account && deploy_aws_config_in_all_allowed_regions_of_management_account && set_s3_public_block_access_in_management_account",
              "risk": "NO_RISK"
            },
            {
              "condition": "delete_default_network_resources_in_management_account && configure_management_account_alerting_for_root_user_login && remove_unnecessary_iam_users_in_management_account && deploy_aws_config_in_all_allowed_regions_of_management_account && set_s3_public_block_access_in_management_account",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "harden_member_accounts",
          "title": "Harden member accounts",
          "description": "Member accounts are defined as all accounts within the organization except for the management account.  Accounts that are created or managed by Control Tower have some initial controls in place.  Additional steps are necessary to fully harden the member accounts.  These steps can be done manually but as you scale, automation will be necessary to ensure hardening of new accounts on creation.",
          "choices": [
            {
              "id": "set_member_root_user_password",
              "title": "Set member account root users",
              "helpfulResource": {
                "displayText": "Any AWS account created through AWS Control Tower or the AWS Organizations console will setup a new AWS account root user. By default, the password is not yet set for the account; however, the email address used to create the account can undergo the process of recovering the password in order to initially set the password.",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys_retrieve.html#reset-root-password"
              },
              "improvementPlan": {
                "displayText": "Set and secure the root user password for member accounts",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys_retrieve.html#reset-root-password"
              }
            },
            {
              "id": "enable_mfa_for_root_users_in_member_accounts",
              "title": "Enable MFA for root users in member accounts",
              "helpfulResource": {
                "displayText": "AWS multi-factor authentication (MFA) is an AWS Identity and Access Management (IAM) best practice that requires a second authentication factor in addition to user name and password sign-in credentials. You can enable MFA at the AWS account level and for root and IAM users you have created in your account.",
                "url": "https://aws.amazon.com/iam/features/mfa/"
              },
              "improvementPlan": {
                "displayText": "Enable MFA for the root user of member accounts",
                "url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html"
              }
            },
            {
              "id": "configure_s3_public_block_access_in_member_accounts",
              "title": "Configure S3 public block access in member accounts",
              "helpfulResource": {
                "displayText": "By default, new S3 buckets and objects don't allow public access. However, users can modify bucket policies, or object permissions to allow public access.  It is a good practice to enable S3 block public access at the account level to ensure that data is not exposed publicly.",
                "url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/configuring-block-public-access-account.html"
              },
              "improvementPlan": {
                "displayText": "Configure S3 block public access at the account level in the member accounts",
                "url": "https://docs.aws.amazon.com/AmazonS3/latest/userguide/configuring-block-public-access-account.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "set_member_root_user_password && enable_mfa_for_root_users_in_member_accounts && configure_s3_public_block_access_in_member_accounts",
              "risk": "NO_RISK"
            },
            {
              "condition": "set_member_root_user_password && enable_mfa_for_root_users_in_member_accounts && !configure_s3_public_block_access_in_member_accounts",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "apply_control_tower_initial_detective_controls",
          "title": "Apply Control Tower initial detective controls",
          "description": "Controls are governance rules for security, operations, and compliance that you can define and apply either across your AWS environment or to specific groups of accounts.  AWS Control Tower provides a set of managed controls that you can apply to the Organizational Units (OUs) in your environment. AWS Control Tower are enabled and enforced by default and protect the resources and controls that AWS Control Tower creates and manages. Additional strongly recommended controls and elective controls can be enabled on desired OUs through the Control Tower console. DETECTIVE CONTROLS continuously monitor deployed resources for nonconformance and generate alerts when nonconformance is detected. You can automate responses to alerts to take action. AWS Control Tower detective controls are implemented using AWS Config rules.",
          "choices": [
            {
              "id": "enable_detective_control_detect_whether_mfa_for_the_root_user_is_enabled",
              "title": "Enable Control Tower detective control detect_whether_mfa_for_the_root_user_is_enabled",
              "helpfulResource": {
                "displayText": "Enable this control for all applicable OUs (it is recommended to enable for all OUs). This control detects whether multi-factor authentication (MFA) is enabled for the root user of the management account. MFA reduces vulnerability risks from weak authentication by requiring an additional authentication code after the user name and password are successful.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/strongly-recommended-controls.html#enable-root-mfa"
              },
              "improvementPlan": {
                "displayText": "Enable AWS Control Tower detective control detect_whether_mfa_for_the_root_user_is_enabled in all OUs",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/enable-controls-on-ou.html"
              }
            },
            {
              "id": "enable_detective_control_detect_whether_public_read_access_to_amazon_s3_buckets_is_allowed",
              "title": "Enable Control Tower detective control detect_whether_public_read_access_to_amazon_s3_buckets_is_allowed",
              "helpfulResource": {
                "displayText": "Enable this control for all applicable OUs (it is recommended to enable for all OUs that are not designed to host public readable S3 buckets). This control detects whether public read access is allowed to Amazon S3 buckets. It helps you maintain secure access to data stored in the buckets.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/strongly-recommended-controls.html#s3-disallow-public-read"
              },
              "improvementPlan": {
                "displayText": "Enable AWS Control Tower detective control detect_whether_public_read_access_to_amazon_s3_buckets_is_allowed in all OUs",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/enable-controls-on-ou.html"
              }
            },
            {
              "id": "enable_detective_control_detect_whether_public_write_access_to_amazon_s3_buckets_is_allowed",
              "title": "Enable Control Tower detective control detect_whether_public_write_access_to_amazon_s3_buckets_is_allowed",
              "helpfulResource": {
                "displayText": "Enable this control for all applicable OUs (it is recommended to enable for all OUs that are not designed to host public writable S3 buckets). This control detects whether public write access is allowed to Amazon S3 buckets. It helps you maintain secure access to data stored in the buckets.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/strongly-recommended-controls.html#s3-disallow-public-write"
              },
              "improvementPlan": {
                "displayText": "Enable AWS Control Tower detective control detect_whether_public_write_access_to_amazon_s3_buckets_is_allowed in all OUs",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/enable-controls-on-ou.html"
              }
            },
            {
              "id": "enable_detective_control_detect_whether_mfa_is_enabled_for_aws_iam_users",
              "title": "Enable Control Tower detective control detect_whether_mfa_is_enabled_for_aws_iam_users",
              "helpfulResource": {
                "displayText": "Enable this control for all applicable OUs (it is recommended to enable for all OUs). This control detects whether MFA is enabled for AWS IAM users. You can protect your account by requiring MFA for all AWS users in the account. MFA requires an additional authentication code after the user name and password are successful.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/elective-controls.html#disallow-access-mfa"
              },
              "improvementPlan": {
                "displayText": "Enable AWS Control Tower detective control detect_whether_mfa_is_enabled_for_aws_iam_users in all OUs",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/enable-controls-on-ou.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "enable_detective_control_detect_whether_mfa_for_the_root_user_is_enabled && enable_detective_control_detect_whether_public_read_access_to_amazon_s3_buckets_is_allowed && enable_detective_control_detect_whether_public_write_access_to_amazon_s3_buckets_is_allowed && enable_detective_control_detect_whether_mfa_is_enabled_for_aws_iam_users",
              "risk": "NO_RISK"
            },
            {
              "condition": "enable_detective_control_detect_whether_mfa_for_the_root_user_is_enabled && enable_detective_control_detect_whether_public_read_access_to_amazon_s3_buckets_is_allowed && enable_detective_control_detect_whether_public_write_access_to_amazon_s3_buckets_is_allowed && !enable_detective_control_detect_whether_mfa_is_enabled_for_aws_iam_users",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "apply_control_tower_initial_preventative_controls",
          "title": "Apply Control Tower initial preventative controls",
          "description": "Controls are governance rules for security, operations, and compliance that you can define and apply either across your AWS environment or to specific groups of accounts.  AWS Control Tower provides a set of managed controls that you can apply to the Organizational Units (OUs) in your environment. AWS Control Tower are enabled and enforced by default and protect the resources and controls that AWS Control Tower creates and manages. Additional strongly recommended controls and elective controls can be enabled on desired OUs through the Control Tower console. PREVENTATIVE CONTROLS allow you to manage permissions in your organization by setting the maximum available permissions for all or some accounts in your organization. Preventative controls help you to ensure your accounts stay within your organization’s access control guidelines. AWS Control Tower preventative controls are implemented using Service Control Policies (SCPs).",
          "choices": [
            {
              "id": "enable_preventative_control_disallow_creation_of_access_keys_for_the_root_user",
              "title": "Enable Control Tower preventative control disallow_creation_of_access_keys_for_the_root_user",
              "helpfulResource": {
                "displayText": "Enable this control for all applicable OUs (it is recommended to enable for all OUs). This control helps secure your AWS accounts by disallowing creation of access keys for the root user.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/strongly-recommended-controls.html#disallow-root-access-keys"
              },
              "improvementPlan": {
                "displayText": "Enable AWS Control Tower preventative control disallow_creation_of_access_keys_for_the_root_user in all OUs",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/enable-controls-on-ou.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "enable_preventative_control_disallow_creation_of_access_keys_for_the_root_user",
              "risk": "NO_RISK"
            },
            {
              "condition": "enable_preventative_control_disallow_creation_of_access_keys_for_the_root_user",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        },
        {
          "id": "apply_organization_hardening_service_control_policies",
          "title": "Apply organization Hardening Service Control Policies (SCPs)",
          "description": "Service control policies (SCPs) are a type of organization policy that you can use to manage permissions in your organization. SCPs offer central control over the maximum available permissions for all accounts in your organization. SCPs help you to ensure your accounts stay within your organization’s access control guidelines. No permissions are granted by an SCP. An SCP defines a guardrail, or sets limits, on the actions that the account's administrator can delegate to the IAM users and roles in the affected accounts.",
          "choices": [
            {
              "id": "create_and_attach_an_scp_to_prevent_member_accounts_from_leaving_the_organization",
              "title": "Create and attach an SCP to prevent member accounts from leaving the organization",
              "helpfulResource": {
                "displayText": "An SCP can be used to block use of the LeaveOrganization API operation so that administrators of member accounts can't remove their accounts from the organization. This SCP should be attached to all OUs in the organization.",
                "url": "https://docs.aws.amazon.com/controltower/latest/userguide/strongly-recommended-controls.html#disallow-root-access-keys"
              },
              "improvementPlan": {
                "displayText": "Create and attach an SCP to prevent member accounts from leaving the organization",
                "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples_general.html"
              }
            },
            {
              "id": "create_and_attach_an_scp_to_prevent_resource_sharing_outside_of_the_organization",
              "title": "Create and attach an SCP to prevent resource sharing outside of the organization",
              "helpfulResource": {
                "displayText": "An SCP can be used to prevent users from creating resource shares that allow sharing with IAM users and roles that aren't part of the organization.",
                "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples_ram.html"
              },
              "improvementPlan": {
                "displayText": "Create and attach an SCP to prevent resource sharing outside of the organization",
                "url": "https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples_ram.html"
              }
            },
            {
              "id": "none_no",
              "title": "None of these",
              "helpfulResource": {
                "displayText": "Chose this if you have not completed any of these tasks.",
                "url": "https://docs.aws.amazon.com/whitepapers/latest/establishing-your-cloud-foundation-on-aws/welcome.html"
              }
            }
          ],
          "riskRules": [
            {
              "condition": "create_and_attach_an_scp_to_prevent_member_accounts_from_leaving_the_organization && create_and_attach_an_scp_to_prevent_resource_sharing_outside_of_the_organization",
              "risk": "NO_RISK"
            },
            {
              "condition": "create_and_attach_an_scp_to_prevent_member_accounts_from_leaving_the_organization && create_and_attach_an_scp_to_prevent_resource_sharing_outside_of_the_organization",
              "risk": "MEDIUM_RISK"
            },
            {
              "condition": "default",
              "risk": "HIGH_RISK"
            }
          ]
        }
      ]
    }
  ]
}
